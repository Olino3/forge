# Component Test Template
# Standard structure for Angular component tests with Jest/Jasmine

/**
 * Tests for {ComponentName}
 *
 * Component: {component_path}
 * Generated by Claude Code using skill:generate-jest-unit-tests
 *
 * Test Coverage:
 * {coverage_list}
 */

import { ComponentFixture, TestBed } from '@angular/core/testing';
import { DebugElement } from '@angular/core';
import { By } from '@angular/platform-browser';
{additional_testing_imports}

import { {ComponentName} } from './{component_file}';
{component_imports}

describe('{ComponentName}', () => {
  let component: {ComponentName};
  let fixture: ComponentFixture<{ComponentName}>;
  let debugElement: DebugElement;
  {mock_declarations}

  beforeEach(async () => {
    {mock_setup}

    await TestBed.configureTestingModule({
      declarations: [{ComponentName}{child_component_declarations}],
      imports: [{test_imports}],
      providers: [{mock_providers}]
    }).compileComponents();

    fixture = TestBed.createComponent({ComponentName});
    component = fixture.componentInstance;
    debugElement = fixture.debugElement;
  });

  afterEach(() => {
    fixture.destroy();
  });

  // ========================================================================
  // COMPONENT CREATION
  // ========================================================================

  it('should_create_component', () => {
    expect(component).toBeTruthy();
  });

  // ========================================================================
  // INPUT PROPERTIES
  // ========================================================================

  {input_tests}

  // ========================================================================
  // OUTPUT PROPERTIES
  // ========================================================================

  {output_tests}

  // ========================================================================
  // TEMPLATE RENDERING
  // ========================================================================

  {template_tests}

  // ========================================================================
  // USER INTERACTIONS
  // ========================================================================

  {interaction_tests}

  // ========================================================================
  // LIFECYCLE HOOKS
  // ========================================================================

  {lifecycle_tests}

  // ========================================================================
  // BUSINESS LOGIC
  // ========================================================================

  {logic_tests}

  // ========================================================================
  // ERROR SCENARIOS
  // ========================================================================

  {error_tests}
});

// ============================================================================
// JEST EXAMPLE (Preferred)
// ============================================================================

/**
 * Tests for UserCardComponent
 *
 * Component: src/app/components/user-card/user-card.component.ts
 * Generated by Claude Code using skill:generate-jest-unit-tests
 *
 * Test Coverage:
 * - Component creation and initialization
 * - Input handling (@Input user)
 * - Output emission (@Output cardClicked)
 * - Template rendering (avatar, name, email display)
 * - Click event handling
 */

import { ComponentFixture, TestBed } from '@angular/core/testing';
import { DebugElement } from '@angular/core';
import { By } from '@angular/platform-browser';

import { UserCardComponent } from './user-card.component';
import { User } from '../../models/user.model';

describe('UserCardComponent', () => {
  let component: UserCardComponent;
  let fixture: ComponentFixture<UserCardComponent>;
  let debugElement: DebugElement;

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      declarations: [UserCardComponent]
    }).compileComponents();

    fixture = TestBed.createComponent(UserCardComponent);
    component = fixture.componentInstance;
    debugElement = fixture.debugElement;
  });

  afterEach(() => {
    fixture.destroy();
  });

  // ========================================================================
  // COMPONENT CREATION
  // ========================================================================

  it('should_create_component', () => {
    expect(component).toBeTruthy();
  });

  // ========================================================================
  // INPUT PROPERTIES
  // ========================================================================

  describe('user input', () => {
    it('should_display_user_info_when_user_provided', () => {
      // Arrange
      const mockUser: User = {
        id: '123',
        name: 'John Doe',
        email: 'john@example.com',
        avatar: 'avatar.jpg'
      };

      // Act
      component.user = mockUser;
      fixture.detectChanges();

      // Assert
      const nameElement = debugElement.query(By.css('.user-name'));
      const emailElement = debugElement.query(By.css('.user-email'));

      expect(nameElement.nativeElement.textContent).toContain('John Doe');
      expect(emailElement.nativeElement.textContent).toContain('john@example.com');
    });

    it('should_display_placeholder_when_user_is_null', () => {
      // Arrange
      component.user = null;

      // Act
      fixture.detectChanges();

      // Assert
      const placeholderElement = debugElement.query(By.css('.placeholder'));
      expect(placeholderElement.nativeElement.textContent).toContain('No user selected');
    });

    it('should_show_default_avatar_when_avatar_missing', () => {
      // Arrange
      const mockUser: User = {
        id: '123',
        name: 'John Doe',
        email: 'john@example.com',
        avatar: ''
      };

      // Act
      component.user = mockUser;
      fixture.detectChanges();

      // Assert
      const avatarElement = debugElement.query(By.css('.user-avatar'));
      expect(avatarElement.nativeElement.src).toContain('default-avatar.png');
    });
  });

  // ========================================================================
  // OUTPUT PROPERTIES
  // ========================================================================

  describe('cardClicked output', () => {
    it('should_emit_user_when_card_clicked', () => {
      // Arrange
      const mockUser: User = { id: '123', name: 'John Doe', email: 'john@example.com' };
      component.user = mockUser;
      fixture.detectChanges();

      let emittedUser: User | undefined;
      component.cardClicked.subscribe((user: User) => {
        emittedUser = user;
      });

      // Act
      const cardElement = debugElement.query(By.css('.user-card'));
      cardElement.nativeElement.click();

      // Assert
      expect(emittedUser).toEqual(mockUser);
    });

    it('should_not_emit_when_user_is_null', () => {
      // Arrange
      component.user = null;
      fixture.detectChanges();

      let emitted = false;
      component.cardClicked.subscribe(() => {
        emitted = true;
      });

      // Act
      const cardElement = debugElement.query(By.css('.user-card'));
      cardElement.nativeElement.click();

      // Assert
      expect(emitted).toBe(false);
    });
  });

  // ========================================================================
  // TEMPLATE RENDERING
  // ========================================================================

  describe('template rendering', () => {
    it('should_update_display_when_input_changes', () => {
      // Arrange
      const user1: User = { id: '1', name: 'User 1', email: 'user1@example.com' };
      const user2: User = { id: '2', name: 'User 2', email: 'user2@example.com' };

      // Act - First user
      component.user = user1;
      fixture.detectChanges();
      let nameElement = debugElement.query(By.css('.user-name'));
      expect(nameElement.nativeElement.textContent).toContain('User 1');

      // Act - Second user
      component.user = user2;
      fixture.detectChanges();
      nameElement = debugElement.query(By.css('.user-name'));

      // Assert
      expect(nameElement.nativeElement.textContent).toContain('User 2');
    });
  });

  // ========================================================================
  // LIFECYCLE HOOKS
  // ========================================================================

  describe('lifecycle hooks', () => {
    it('should_initialize_with_default_values_on_init', () => {
      // Act
      component.ngOnInit();

      // Assert
      expect(component.isSelected).toBe(false);
    });
  });
});

// ============================================================================
// JASMINE/KARMA EXAMPLE
// ============================================================================

describe('UserCardComponent (Jasmine)', () => {
  let component: UserCardComponent;
  let fixture: ComponentFixture<UserCardComponent>;

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      declarations: [ UserCardComponent ]
    })
    .compileComponents();
  });

  beforeEach(() => {
    fixture = TestBed.createComponent(UserCardComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () => {
    expect(component).toBeTruthy();
  });

  it('should_display_user_name', () => {
    const mockUser: User = {
      id: '1',
      name: 'Test User',
      email: 'test@example.com'
    };
    component.user = mockUser;
    fixture.detectChanges();

    const compiled = fixture.nativeElement as HTMLElement;
    expect(compiled.querySelector('.user-name')?.textContent).toContain('Test User');
  });
});

// ============================================================================
// COMPONENT WITH SERVICES
// ============================================================================

describe('ProductListComponent (with service)', () => {
  let component: ProductListComponent;
  let fixture: ComponentFixture<ProductListComponent>;
  let mockProductService: jest.Mocked<ProductService>;

  beforeEach(async () => {
    mockProductService = {
      getProducts: jest.fn(),
      deleteProduct: jest.fn()
    } as any;

    await TestBed.configureTestingModule({
      declarations: [ProductListComponent],
      providers: [
        { provide: ProductService, useValue: mockProductService }
      ]
    }).compileComponents();

    fixture = TestBed.createComponent(ProductListComponent);
    component = fixture.componentInstance;
  });

  it('should_load_products_on_init', () => {
    // Arrange
    const mockProducts = [{ id: '1', name: 'Product 1' }];
    mockProductService.getProducts.mockReturnValue(of(mockProducts));

    // Act
    fixture.detectChanges(); // Triggers ngOnInit

    // Assert
    expect(mockProductService.getProducts).toHaveBeenCalled();
    expect(component.products).toEqual(mockProducts);
  });
});

// ============================================================================
// COMPONENT WITH NGRX STORE
// ============================================================================

import { provideMockStore, MockStore } from '@ngrx/store/testing';
import { selectAllProducts, selectLoading } from './store/product.selectors';
import { loadProducts } from './store/product.actions';

describe('ProductListComponent (with NgRx)', () => {
  let component: ProductListComponent;
  let fixture: ComponentFixture<ProductListComponent>;
  let store: MockStore;

  const initialState = {
    products: {
      entities: [],
      loading: false
    }
  };

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      declarations: [ProductListComponent],
      providers: [
        provideMockStore({ initialState })
      ]
    }).compileComponents();

    store = TestBed.inject(MockStore);
    spyOn(store, 'dispatch');

    fixture = TestBed.createComponent(ProductListComponent);
    component = fixture.componentInstance;
  });

  it('should_dispatch_loadProducts_on_init', () => {
    // Act
    fixture.detectChanges();

    // Assert
    expect(store.dispatch).toHaveBeenCalledWith(loadProducts());
  });

  it('should_display_products_from_store', () => {
    // Arrange
    const mockProducts = [{ id: '1', name: 'Product 1' }];
    store.overrideSelector(selectAllProducts, mockProducts);
    store.overrideSelector(selectLoading, false);

    // Act
    fixture.detectChanges();

    // Assert
    const productElements = fixture.nativeElement.querySelectorAll('.product-item');
    expect(productElements.length).toBe(1);
  });
});
