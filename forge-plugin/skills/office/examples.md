# Office Skill Examples

This file contains example scenarios demonstrating how to use the office skill to generate professional documents (DOCX, XLSX, PDF, PPTX) with TypeScript.

---

## Example 1: Professional DOCX Report with Headers, Tables, Images, and Page Numbers

### Scenario
Engineering manager needs a quarterly performance report as a Word document with a cover page, executive summary, data tables, embedded charts as images, and branded headers/footers with page numbers.

### User Prompt
```
Generate a TypeScript script that creates a professional quarterly report DOCX. It should have a cover page with the company name and report title, an executive summary section, a table of KPIs with RAG status, an embedded chart image, and headers/footers with the company logo and page numbers. Use the docx library.
```

### Skill Execution

**Step 1 - Initial Analysis**:
- **Document type**: DOCX (Word)
- **Content structure**: Cover page, executive summary paragraph, KPI table (5 columns × 8 rows), embedded PNG chart image, headers/footers
- **Styling**: Corporate fonts (Calibri), branded colors, centered cover page, alternating row colors in table
- **Runtime**: Node.js (CLI script)

**Step 2 - Load Memory**:
- Check `document_templates.md` for existing report templates
- Check `library_patterns.md` for proven `docx` library patterns (table styling, image embedding, header/footer setup)

**Step 3 - Load Context**:
- Load engineering context for TypeScript conventions and project structure

**Step 4 - Select Library and Configure**:
- Library: `docx` (npm package `docx`)
- Configure: A4 page size, 1-inch margins, document metadata (author, title, description)
- TypeScript types: `Document`, `Paragraph`, `Table`, `TableRow`, `TableCell`, `ImageRun`, `Header`, `Footer`, `PageNumber`

**Step 5 - Generate Document Code**:
- Cover page: centered title with large font, company name, date, spacer paragraphs
- Executive summary: styled heading + body paragraph with key metrics bolded
- KPI table: header row with dark background and white text, data rows with alternating shading, RAG status cells with color-coded backgrounds
- Chart image: embedded from file buffer using `ImageRun` with specified dimensions
- Header: company logo image aligned left, report title aligned right
- Footer: page number centered using `PageNumber.CURRENT` / `PageNumber.TOTAL_PAGES`
- File output: `fs.writeFileSync("quarterly-report.docx", buffer)`

**Step 6 - Add Data Binding**:
- KPI data defined as a typed array; table rows generated by iterating over the array
- RAG status mapped to cell background colors via a lookup object
- Report title, date, and author injected as template variables

**Step 7 - Generate Output**:
- Saved to `/claudedocs/office_{project}_{date}.md`
- Includes: full TypeScript source, `npm install docx` command, `npx tsx generate-report.ts` run instruction

---

## Example 2: Multi-Sheet XLSX Spreadsheet with Formulas, Charts, and Styled Headers

### Scenario
Finance team needs a monthly budget spreadsheet with three sheets (Revenue, Expenses, Summary), formulas that sum and reference across sheets, styled headers with freeze panes, and conditional formatting for over-budget items.

### User Prompt
```
Create a TypeScript script that generates a multi-sheet Excel spreadsheet for monthly budgeting. Sheet 1 is Revenue with category, projected, and actual columns. Sheet 2 is Expenses with the same structure. Sheet 3 is Summary that pulls totals from both sheets with variance formulas. Add styled headers, freeze the top row, and highlight cells where actual exceeds projected in red. Use SheetJS (xlsx).
```

### Skill Execution

**Step 1 - Initial Analysis**:
- **Document type**: XLSX (Excel)
- **Content structure**: 3 sheets (Revenue, Expenses, Summary), cross-sheet formulas, styled headers, conditional formatting
- **Styling**: Bold headers with blue background, freeze panes on row 1, red fill for over-budget cells
- **Runtime**: Node.js (CLI script)

**Step 2 - Load Memory**:
- Check `document_templates.md` for existing spreadsheet structures
- Check `library_patterns.md` for SheetJS cell styling, formula syntax, and cross-sheet references

**Step 3 - Load Context**:
- Load engineering context for TypeScript project conventions

**Step 4 - Select Library and Configure**:
- Library: SheetJS (npm package `xlsx`)
- Configure: workbook creation with `XLSX.utils.book_new()`, sheet creation with `XLSX.utils.aoa_to_sheet()`
- TypeScript types: `WorkBook`, `WorkSheet`, `CellObject`
- Note: SheetJS community edition has limited styling — use `xlsx-js-style` fork for cell formatting if full styling is needed

**Step 5 - Generate Document Code**:
- Revenue sheet: header row ["Category", "Projected", "Actual", "Variance"], data rows with sample revenue categories, variance formula `=C2-B2` in column D
- Expenses sheet: same structure with expense categories
- Summary sheet: total revenue row with `=SUM(Revenue!C2:C10)`, total expenses row with cross-sheet reference, net income with formula, variance percentage
- Header styling: bold font, blue background (`{fill: {fgColor: {rgb: "4472C4"}}}`), white text
- Freeze panes: `ws["!freeze"] = {xSplit: 0, ySplit: 1}` to lock the header row
- Column widths: `ws["!cols"] = [{wch: 20}, {wch: 15}, {wch: 15}, {wch: 15}]`
- Conditional formatting: iterate cells and apply red fill where actual > projected
- File output: `XLSX.writeFile(workbook, "monthly-budget.xlsx")`

**Step 6 - Add Data Binding**:
- Revenue and expense data defined as typed arrays
- Rows generated by mapping data arrays to sheet arrays
- Formulas constructed dynamically based on data row count
- Summary sheet formulas reference exact cell ranges from data sheets

**Step 7 - Generate Output**:
- Saved to `/claudedocs/office_{project}_{date}.md`
- Includes: full TypeScript source, `npm install xlsx` (or `xlsx-js-style` for styling), `npx tsx generate-budget.ts` run instruction

---

## Example 3: PDF Invoice with Custom Layout, Logo, Line Items Table, and Totals

### Scenario
A SaaS company needs to generate PDF invoices programmatically. Each invoice has a company logo, client billing details, a line items table with quantities and prices, subtotal/tax/total calculations, and payment terms in the footer.

### User Prompt
```
Build a TypeScript script that generates a professional PDF invoice using pdf-lib. Include the company logo in the top-left, billing/shipping addresses on the right, an invoice number and date, a line items table with description, quantity, unit price, and amount columns, subtotal/tax/total at the bottom, and payment terms in the footer. The layout should look like a real invoice.
```

### Skill Execution

**Step 1 - Initial Analysis**:
- **Document type**: PDF
- **Content structure**: Logo, addresses, invoice metadata, line items table, totals section, footer
- **Styling**: Clean professional layout, precise coordinate positioning, embedded font, horizontal rules
- **Runtime**: Node.js (CLI script)

**Step 2 - Load Memory**:
- Check `document_templates.md` for existing invoice layouts and coordinate systems
- Check `library_patterns.md` for pdf-lib text drawing, table rendering, and image embedding patterns

**Step 3 - Load Context**:
- Load engineering context for TypeScript conventions

**Step 4 - Select Library and Configure**:
- Library: pdf-lib (npm package `pdf-lib`)
- Configure: create new PDF with `PDFDocument.create()`, add A4 page with `pdf.addPage(PageSizes.A4)`
- TypeScript types: `PDFDocument`, `PDFPage`, `PDFFont`, `rgb`, `PageSizes`
- Additional dependency: `@pdf-lib/fontkit` if custom fonts are needed
- Note: pdf-lib uses coordinate origin at bottom-left; Y coordinates increase upward

**Step 5 - Generate Document Code**:
- Page setup: A4 (595.28 × 841.89 points), define margins (50pt), embed Helvetica font
- Logo: embed PNG image from file with `pdf.embedPng(logoBytes)`, draw at top-left with `page.drawImage()` at specified dimensions
- Company info: draw company name, address lines below logo using `page.drawText()` with Y offsets
- Client info: draw "Bill To" and "Ship To" blocks on the right side of the page
- Invoice metadata: invoice number, date, due date — right-aligned below the header
- Horizontal rule: `page.drawLine()` to separate header from body
- Line items table:
  - Draw column headers: Description (x=50), Qty (x=350), Unit Price (x=410), Amount (x=490)
  - Iterate line items array, drawing each row with calculated Y position
  - Draw light gray background on alternating rows using `page.drawRectangle()`
  - Right-align numeric columns
- Totals section: subtotal, tax (calculated), total — right-aligned below the table with a separator line
- Footer: payment terms text and "Thank you for your business" at the bottom of the page
- File output: `fs.writeFileSync("invoice.pdf", await pdf.save())`

**Step 6 - Add Data Binding**:
- Invoice data defined as a typed interface: `InvoiceData` with company, client, items, tax rate
- Line items iterated to draw table rows and calculate subtotal
- Tax calculated from subtotal × tax rate
- Total = subtotal + tax
- All text positions calculated dynamically based on content length and item count
- Page overflow handling: if items exceed page height, add a new page and continue

**Step 7 - Generate Output**:
- Saved to `/claudedocs/office_{project}_{date}.md`
- Includes: full TypeScript source, `npm install pdf-lib` command, `npx tsx generate-invoice.ts` run instruction, sample invoice data object

---

## Summary of Document Types

| Type | Library | Key Patterns |
|------|---------|-------------|
| **DOCX** | `docx` | Paragraph-based model, `Document` → `Section` → `Paragraph`/`Table`, `ImageRun` for images, `Header`/`Footer` for page elements |
| **XLSX** | `xlsx` / `xlsx-js-style` | Workbook → Sheet → Cell model, `aoa_to_sheet` for array data, cell references for formulas, `!cols`/`!rows` for sizing |
| **PDF** | `pdf-lib` | Coordinate-based drawing, origin at bottom-left, `drawText`/`drawImage`/`drawLine`/`drawRectangle`, font embedding required |
| **PPTX** | `pptxgenjs` | Slide-based model, `addSlide()` → `addText`/`addImage`/`addChart`/`addTable`, inches for positioning |

## Best Practices

- Always use TypeScript for type safety — the document libraries have excellent type definitions
- Embed fonts explicitly in PDF generation to ensure consistent rendering across systems
- Use data-driven patterns: define content as typed arrays/objects, then iterate to build document elements
- Handle page/slide overflow: check remaining space before adding content, create new pages/slides as needed
- Test with real data volumes — a 3-row table looks fine, but 300 rows may need pagination logic
- For DOCX and PPTX, use the library's built-in style system rather than manual formatting
- For XLSX, be aware that the community edition of SheetJS has limited styling; use `xlsx-js-style` if cell formatting is critical
- Keep document generation scripts self-contained with sample data for easy testing and iteration
